kind: pipeline
type: docker
name: default

steps:
- name: slack
  image: plugins/slack
  privileged: true
  settings:
    webhook:
      from_secret: slack_webhook
    channel: general

    # - name: docker-build
    #   image: plugins/docker:18.09
    #   privileged: true
    #   settings:
    #     username:
    #       from_secret: docker_username
    #     password:
    #       from_secret: docker_password
    #     repo: kafuhamada/sample
    #     tags: latest
    #     debug: true

- name: publish
  image: plugins/gcr
  settings:
    registry: us.gcr.io
    repo: ipu-project/foo/bar
    tags: latest
    json_key:
      from_secret: google_credentials

trigger:
  branch:
    - master
  event:
    - pull_request
